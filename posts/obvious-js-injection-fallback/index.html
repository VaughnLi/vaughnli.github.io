<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="color-scheme" content="light dark">
	<link rel="icon" href="data:,">
	<title>Obvious Javascript 'Injection' Fallback</title>
	<link href="/index.rss" type="application/rss+xml" rel="alternate" title="RSS feed for blog posts" />
	<link rel="stylesheet" href="/public/style.css?v=1.0">
</head>

<header id="top">
	<nav>
		<a href="/"><b>vaughn.li</b></a><span> | </span><a href="#menu">Menu</a>
	</nav>
</header>

<main>
<h1 id="obvious-javascript-injection-fallback">Obvious Javascript ‘Injection’ Fallback</h1>

<p>2020-12-04</p>

<p>Sometimes websites and web apps might require content to be “injected” via Javascript. I should mention that I am strongly against this practice - but often this kind of thing is out of one’s hands. So, the least I can do is setup these “injections” to have proper fallbacks for users who disable JS. You would be surprised how many developers build <em>empty</em> HTML elements with the assumption they will be filled via Javascript.</p>

<h2 id="our-hypothetical-project">Our Hypothetical Project</h2>

<p>Let’s pretend that we have a total tally that pulls in the number of current users using our fake SaaS app. We would do something like this:</p>

<h3 id="html">HTML</h3>

<p>Here we create an empty <code>h2</code> tag that will update with the current number of users via js:</p>

<pre><code class="language-html">&lt;main&gt;
    &lt;h2 class="total-tally"&gt;&lt;/h2&gt;
&lt;/main&gt;
</code></pre>

<h3 id="javascript">Javascript</h3>

<p>You’ll have to use your imagination here and assume that the <code>totalTally</code> variable pulls in the numbers dynamically via API:</p>

<pre><code class="language-html">var totalTally = "273,677" /* This would pull something dynamically in prod */
document.getElementsByClassName("total-tally")[0].innerHTML=totalTally;
</code></pre>

<h2 id="the-problem">The Problem</h2>

<p>The big issue we have now occurs when a user visits this page without JS enabled. The <code>h2</code> tag will remain empty and they won’t see anything. I know this seems like a very avoidable issue, but you would be surprised how often it actually happens on the web.</p>

<h2 id="the-overly-simple-solution">The (overly simple) Solution</h2>

<p>The easiest way to avoid these types of empty tags - add static content. I know - mind blowing, right?</p>

<h3 id="html-updated">HTML (updated)</h3>

<pre><code class="language-html">&lt;main&gt;
    &lt;h2 class="total-tally"&gt;200,000+&lt;/h2&gt;
&lt;/main&gt;
</code></pre>

<p>You might be reading this and saying to yourself, “Wow! Thanks Captain Obvious!” and that’s a fair reaction. This is an <em>obvious</em> demo on purpose. If even one single reader learns to avoid leaving empty HTML tags that are solely dependent on Javascript injection, then I’d say this demo was a huge success.</p>

<p>Rule of thumb: don’t make assumption about your users. Play it safe.</p>
</main>

<footer role="contentinfo">
    <nav id="menu">
        <ul>
            <li><a href="/">Home</a></li>
            <li><a href="/about">About</a></li>
            <li><a href="/index.rss">RSS</a></li>
            <li><a href="#top">&uarr; Top</a></li>
        </ul>
    </nav>
    <small>
        Built with <a href="https://wruby.btxx.org">wruby</a> <br>
        Running on <a href="https://openbsd.org">OpenBSD</a> via <a href="https://billing.linveo.com/order/forms/a/MTM4Ng==">Linveo</a><br>
        Supporter of <a href="https://nextdns.io/?from=74d3p3h8">NextDNS</a> & <a href="https://usefathom.com/ref/DKHJVX">Fathom Analytics</a><br/>
        The content for this site is <a
          href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a><br>
        The <a href="https://git.sr.ht/~bt/btxx.org">code for this site</a>
        is <a href="https://git.sr.ht/~bt/btxx.org/tree/master/item/LICENSE">MIT</a>
    </small>
</footer>
